--[=[
 o-----------------------------------------------------------------------------o
 |
 | Matrix module regression tests - data for real matrices
 |
 | Methodical Accelerator Design - Copyright CERN 2016+
 | Support: http://cern.ch/mad  - mad at cern.ch
 | Authors: L. Deniau, laurent.deniau at cern.ch
 |          A.Z. Teska, aleksandra.teska at cern.ch
 | Contrib: -
 |
 o-----------------------------------------------------------------------------o
 | You can redistribute this file and/or modify it under the terms of the GNU
 | General Public License GPLv3 (or later), as published by the Free Software
 | Foundation. This file is distributed in the hope that it will be useful, but
 | WITHOUT ANY WARRANTY OF ANY KIND. See http://gnu.org/licenses for details.
 o-----------------------------------------------------------------------------o

  Purpose:
  - Provide matlab created output regression test suites for the matrix module.

 o-----------------------------------------------------------------------------o
]=]

local vector, cvector, matrix, cmatrix in MAD
local sqrt                             in MAD.gmath
local eps, inf, nan, pi                in MAD.constant

-- locals ---------------------------------------------------------------------o

local M = {}

-- linear algebra -------------------------------------------------------------o

-- eigen
M.eigenIn = {
matrix{
  {1, 1, 1, 1},
  {0, 2, 2, 2},
  {0, 0, 3, 3},
  {0, 0, 0, 4}
},
matrix{
  {3, 1, 0},
  {0, 3, 1},
  {0, 0, 3},
  },
matrix{
  { 3.0  ,-2.0  ,-0.9, 2*eps},
  {-2.0  , 4.0  , 1.0,-eps  },
  {-eps/4, eps/2,-1.0, 0    },
  {-0.5  ,-0.5  , 0.1, 1.0  },
  },
matrix{
  { 1, 7 , 3 },
  { 2, 9 , 12},
  { 5, 22, 7 },
  },
}

-- w (values)
M.eigenD = {
matrix{
  {1, 0, 0, 0},
  {0, 2, 0, 0},
  {0, 0, 3, 0},
  {0, 0, 0, 4},
  },
matrix{
  {3, 0, 0},
  {0, 3, 0},
  {0, 0, 3},
  },
matrix{
  {5.561552812808834, 0                , 0                 , 0},
  {0                , 1.438447187191171, 0                 , 0},
  {0                , 0                , 0.9999999999999999, 0},
  {0                , 0                , 0                 ,-1},
  },
matrix{
  {25.55483863429071, 0                 , 0                },
  {0                ,-0.5789337929080569, 0                },
  {0                , 0                 ,-7.975904841382666},
  },
}

-- vr
M.eigenV = {
matrix{
  {1, 0.707106781186548, 0.557086014531156, 0.463427557090794},
  {0, 0.707106781186548, 0.742781352708207, 0.695141335636191},
  {0, 0                , 0.371390676354104, 0.521356001727143},
  {0, 0                , 0                , 0.173785333909048},
  },

matrix{
  {1,-1                   , 1                   },
  {0, 6.66133814775094e-16,-6.66133814775094e-16},
  {0, 0                   , 4.43734259186819e-31},
  },
matrix{
  { 0.615301855596054   ,-0.417622469697774   ,-4.44089209850062e-16,-0.152821435699993 },
  {-0.788064099464283   ,-0.326069771124365   ,-2.22044604925031e-16, 0.134482863415994 },
  {-1.85396366744117e-17,-5.33877163674955e-18,-6.62038418383103e-34,-0.978057188479956 },
  { 0.0189367799692150  , 0.848097858246580   ,-1                   , 0.0443182163529980},
  },

matrix{
  {-0.260976503318146,-0.973445274559594 , 0.189104107807029},
  {-0.587027077498621, 0.228061283850043 ,-0.581572782101413},
  {-0.766348794609388,-0.0198077824671653, 0.791209665973142},
},
}

-- vl
M.eigenW = {
matrix{
  { 0.662589156449079, 0                , 0                , 0},
  {-0.662589156449079, 0.333333333333333, 0                , 0},
  { 0.331294578224540,-0.666666666666667, 0.316227766016838, 0},
  {-0.110431526074847, 0.666666666666667,-0.948683298050514, 1},
  },
matrix{
  { 4.43734259186819e-31, 0                   , 0},
  {-6.66133814775094e-16, 6.66133814775094e-16, 0},
  { 1                   ,-1                   , 1},
  },
matrix{
  { 0.602929602215022   ,-0.787620779108487   ,-0.662251655629139 ,-3.46944695195361e-18},
  {-0.772218009239799   ,-0.614955721521770   ,-0.529801324503311 , 2.08166817117217e-17},
  {-0.200387726616569   , 0.0385093350264578  ,0.00662251655629148,-1                   },
  { 9.62876878652362e-17,-4.86321489687467e-16,-0.529801324503312 , 9.24446373305873e-33},
  },

matrix{
  {-0.179108285735172,-0.958732627596164 ,-0.188133371464411},
  {-0.812659411334709, 0.0648538806540042,-0.747709565272864},
  {-0.554531246324436, 0.276813516553422 , 0.636817274059756},
  },
}

-- svd
M.svdIn = {
matrix{
  { 1, 0, 1},
  {-1,-2, 0},
  { 0, 1,-1},
},
matrix{
  {1, 2},
  {3, 4},
  {5, 6},
  {7, 8},
},
matrix{
  {2, 0, 2},
  {0, 1, 0},
  {0, 0, 0},
},
}

M.svdU = {
matrix{
  {-0.120000260381534,-0.809712281592778, 0.574426634607223},
  { 0.901752646908814, 0.153122822484369, 0.404222172854692},
  {-0.415261485453819, 0.566497504206538, 0.711785414592383},
},
matrix{
  {-0.152483233310201,-0.822647472225660 ,-0.394501022283829,-0.379959133877596 },
  {-0.349918371807964,-0.421375287684580 , 0.242796545704358, 0.800655879510063 },
  {-0.547353510305727,-0.0201031031435017, 0.697909975442775,-0.461434357387337 },
  {-0.744788648803490, 0.381169081397574 ,-0.546205498863304, 0.0407376117548703},
},
matrix{
  {1, 0, 0},
  {0, 1, 0},
  {0, 0, 1},
},
}

M.svdS = {
matrix{
  {2.46050487001876, 0               , 0                },
  {0               , 1.69962814827532, 0                },
  {0               , 0               , 0.239123278256554},
},
matrix{
  {14.2690954992615,0                },
  {0               ,0.626828232417542},
  {0               ,0                },
  {0               ,0                },
},
matrix{
  {2.82842712474619, 0, 0},
  {0               , 1, 0},
  {0               , 0, 0},
},
}

M.svdV = {
matrix{
  {-0.415261485453819,-0.566497504206539, 0.711785414592383},
  {-0.901752646908814, 0.153122822484370,-0.404222172854692},
  { 0.120000260381534,-0.809712281592779,-0.574426634607224},
},
matrix{
  {-0.641423027995072, 0.767187395072177},
  {-0.767187395072177,-0.641423027995072},
},
matrix{
  {0.707106781186548, 0,-0.707106781186548},
  {0                , 1, 0                },
  {0.707106781186548, 0, 0.707106781186548},
},
}

-- solve
M.solveIn1 = {
  matrix(3):eye(),
  matrix{{1, 1, 1},
         {2, 3, 5},
         {4, 0, 5}},
  matrix{{1, 1, 2, 0},
         {2,-1, 0, 1},
         {1,-1,-1,-2},
         {2,-1, 2,-1}},
  matrix{{ 1.44, -7.84, -4.39,  4.53},
         {-9.96, -0.28, -3.24,  3.83},
         {-7.55,  3.24,  6.27, -6.64},
         { 8.34,  8.09,  5.28,  2.06},
         { 7.08,  2.52,  0.74, -2.47},
         {-5.45, -5.70, -1.19,  4.70}},
  matrix{{-0.09,  0.14, -0.46,  0.68,  1.29},
         {-1.56,  0.20,  0.29,  1.09,  0.51},
         {-1.48, -0.43,  0.89, -0.71, -0.96},
         {-1.09,  0.84,  0.77,  2.11, -1.27},
         { 0.08,  0.55, -1.13,  0.14,  1.74},
         {-1.59, -0.72,  1.06,  1.24,  0.34}},
}

M.solveIn2 = {
  matrix(3):fill(1..9),
  vector {5, 8, 2},
  vector {1,-2, 4, 0},
  matrix{{ 8.58,  9.35},
         { 8.26, -4.43},
         { 8.48, -0.70},
         {-5.28, -0.26},
         { 5.72, -7.36},
         { 8.93, -2.52}},
  vector {7.4, 4.2, -8.3, 1.8, 8.6, 2.1},
}

M.solveRnk = {  3,  3,  4,  4,  4   }
M.solveTol = { -1, -1, -1, -1, 1e-2 }
M.solveOut = {
  matrix(3):fill(1..9),
  vector {3, 4,-2},
  vector {1, 2,-1,-2},
  matrix{{-4.5063713541953415e-01,  2.4974799792600089e-01},
         {-8.4915021471399543e-01, -9.0201926064896909e-01},
         { 7.0661216240939528e-01,  6.3234303359817379e-01},
         { 1.2888575215577852e-01,  1.3512363503297237e-01}},
  vector { 6.3439573140483951e-01,  9.6990869209515518e-01,
          -1.4402402680341950e+00,  3.3677744086717514e+00,
           3.3991723892436676e+00},
}

-- nsolve
M.nsolveIn1 = {
  matrix{{1, 1, 1},
         {2, 3, 5},
         {4, 0, 5}},
  matrix{{1, 1, 2, 0},
         {2,-1, 0, 1},
         {1,-1,-1,-2},
         {2,-1, 2,-1}},
  matrix{{ 1.44, -7.84, -4.39,  4.53},
         {-9.96, -0.28, -3.24,  3.83},
         {-7.55,  3.24,  6.27, -6.64},
         { 8.34,  8.09,  5.28,  2.06},
         { 7.08,  2.52,  0.74, -2.47},
         {-5.45, -5.70, -1.19,  4.70}},
  matrix{{-0.09,  0.14, -0.46,  0.68,  1.29},
         {-1.56,  0.20,  0.29,  1.09,  0.51},
         {-1.48, -0.43,  0.89, -0.71, -0.96},
         {-1.09,  0.84,  0.77,  2.11, -1.27},
         { 0.08,  0.55, -1.13,  0.14,  1.74},
         {-1.59, -0.72,  1.06,  1.24,  0.34}},
}

M.nsolveIn2 = {
  vector {5, 8, 2},
  vector {1,-2, 4, 0},
  vector {7.4, 4.2, -8.3, 1.8, 8.6, 2.1},
  vector {7.4, 4.2, -8.3, 1.8, 8.6, 2.1},
}

M.nsolveRnk = { 3,4,4,5, }
M.nsolveRes = {
  1.1785110229670080e-14,
  1.0877919644084146e-15,
  8.9799329453210213e+00,
  3.4752142050027413e-03,
}
M.nsolveOut1 = {
  vector { 2.9999999999999889e+00,
           3.9999999999999938e+00,
          -1.9999999999999922e+00},
  vector { 9.9999999999999933e-01,
           1.9999999999999991e+00,
          -9.9999999999999956e-01,
          -2.0000000000000000e+00},
  vector { 3.6444340051292995e-01,
           2.0048446416218840e-01,
          -8.5183552841459342e-01,
           4.8922174674044538e-01},
  vector {-7.9974472689900555e-01,
          -3.2879635059924852e+00,
          -7.4749842651409892e+00,
           4.9392731451253837e+00,
           7.6783344086773708e-01},
}

M.nsolveOut2 = {
  vector {0,0,0},
  vector {0,0,0,0},
  vector { 2.4912672198186590e+00,
           3.2523255169950072e+00,
           2.3914191715031863e+00,
           6.2851751639379672e-01,
           7.3532558801554400e+00,
           1.9159514900264836e+00},
  vector { 6.3422604854241065e-04,
           2.3335810977213075e-03,
          -7.0647113976610154e-04,
          -8.1238944020044777e-04,
          -1.9011405889451990e-03,
          -1.2065888850675184e-03},
}

-- ssolve
M.ssolveIn1 = {
  matrix{{ 0.12, -8.19,  7.69, -2.26, -4.71},
         {-6.91,  2.22, -5.12, -9.08,  9.96},
         {-3.33, -8.94, -6.72, -4.40, -9.98},
         { 3.97,  3.33, -2.74, -7.92, -3.20}},
  matrix{{-0.09, -1.56, -1.48, -1.09,  0.08, -1.59},
         { 0.14,  0.20, -0.43,  0.84,  0.55, -0.72},
         {-0.46,  0.29,  0.89,  0.77, -1.13,  1.06},
         { 0.68,  1.09, -0.71,  2.11,  0.14,  1.24},
         { 1.29,  0.51, -0.96, -1.27,  1.74,  0.34}},
}

M.ssolveIn2 = {
  matrix{{ 7.30,  0.47, -6.28},
         { 1.33,  6.58, -3.42},
         { 2.68, -1.71,  3.46},
         {-9.62, -0.79,  0.41}},
  vector { 7.4, 4.3, -8.1, 1.8, 8.7},
}

M.ssolveRnk  = {  4,  4   }
M.ssolveTol  = { -1, 1e-2 }
M.ssolveOut1 = {
  matrix{{-6.8576484950692762e-01,-2.4312614090308660e-01, 6.4233067528574439e-02},
         {-7.9500524727957345e-01,-8.3631252225131458e-02, 2.1178661689021339e-01},
         { 3.7668143573729429e-01, 1.2078492507908326e-01,-6.5405631578810208e-01},
         { 2.8849606330103178e-01,-2.4150818886011571e-01, 4.1758938949230046e-01},
         { 2.9160941211004993e-01, 3.5252853492515246e-01,-3.0154342099586517e-01}},
  vector { 1.5937700284689473e+00,
          -1.1795440215617115e-01,
          -3.1501246787206525e+00,
           1.5537312506212497e-01,
           2.5529173541519832e+00,
          -1.6730237091664768e+00},
}

M.ssolveOut2 = {
  vector{1.8661317305260084e+01,
         1.5988138226151460e+01,
         1.0013670581414257e+01,
         8.5072541974947882e+00},
  vector{3.9996534877789536e+00,
         2.9962473455460699e+00,
         2.0000762147785562e+00,
         9.9883067176778284e-01,
         2.4992436436896376e-03},
}

-- gsolve
M.gsolveIn1 = {
  matrix{{-0.57, -1.28, -0.39,  0.25},
         {-1.93,  1.08, -0.31, -2.14},
         { 2.30,  0.24,  0.40, -0.35},
         {-1.93,  0.64, -0.66,  0.08},
         { 0.15,  0.30,  0.15, -2.13},
         {-0.02,  1.03, -1.43,  0.50}},
  matrix{{2,  4, 10, 8, 8},
         {1,  7,  5, 8, 2},
         {3, 10,  3, 8, 7}},
}

M.gsolveIn2 = {
  matrix{{1.00, 0.00, -1.00,  0.00},
         {0.00, 1.00,  0.00, -1.00}},
  matrix{{9, 9, 10, 9, 4},
         {2, 6,  6, 8, 6}, 
         {2, 8,  7, 2, 4},
         {7, 2,  1, 6, 5}},
}

M.gsolveIn3 = {
  vector{-1.50, -2.14, 1.23, -0.54, -1.68, 0.82},
  vector{5, 3, 1}
}

M.gsolveIn4 = {
  vector{0, 0},
  vector{4.425040250545864,
   3.091021371385722,
   2.133626298493637,
   0.482157429258289}
}

M.gsolveRes = { 2.5051814881319748e-02, 6*eps}
M.gsolveOut = {
  vector{4.8904464484136134e-01,
         9.9754816513017031e-01,
         4.8904464484136129e-01,
         9.9754816513017019e-01},
  vector{-0.084697073289076,
  -0.125725061202885,
   0.466437661277872,
   0.230100791777861,
  -0.104111069451490}
}

-- gmsolve
M.gmsolveIn1 = {
  matrix{{-0.57, -1.28, -0.39},
         {-1.93,  1.08, -0.31},
         { 2.30,  0.24, -0.40},
         {-0.02,  1.03, -1.43}},
}

M.gmsolveIn2 = {
  matrix{{0.5, 0, 0, 0},
         {0  , 1, 0, 0},
         {0  , 0, 2, 0},
         {0  , 0, 0, 5}},
}

M.gmsolveIn3 = {
  vector{1.32, -4.00, 5.52, 3.24},
}

M.gmsolveRes  = { 9.3774670220898217e-03 }
M.gmsolveOut1 = {
  vector{ 1.9888667069361583e+00,
         -1.0058128551241214e+00,
         -2.9911074977539860e+00},
}

M.gmsolveOut2 = {
  vector{-6.3671145864938343e-04,
         -2.4526963829010081e-03,
         -4.7206699124839532e-03,
          7.6961706256735100e-03},
}

-- FFT ------------------------------------------------------------------------o

M.sv = { 1, 2, 3, 4, 5, 7, 9, 11, 13, 19, 25 }
M.nfftsv = { 2, 4, 6, 8, 10, 12, 18, 24 }
M.sm = { 2, 5, 7 }                             

M.fftVIn = vector{
  0.501282913203215,
  0.431721171884247,
  0.997560349512189,
  0.811602580995323,
  0.485651669898018,
  0.894447755567393,
  0.137546594767065,
  0.390004914445285,
  0.927356224998125,
  0.917493832416117,
  0.713574011594316,
  0.618337383621940,
  0.343287890241345,
  0.936027326689770,
  0.124774040660493,
  0.730585361505707,
  0.646477432425814,
  0.833151985669295,
  0.398282228218775,
  0.749822209360636,
  0.835220510478131,
  0.322460397362259,
  0.552261616858355,
  0.979129132433892,
  0.549308533018303,
}

M.nfftVPosIn = vector{
0,-1,1,-2,2,-3,3,-4,4,-5,5,-6,6,-7,7,-8,8,-9,9,-10,10,-11,11,-12
}
M.nfftMPosIn = vector{
  -0.5,-0.472857142857143,-0.445714285714286,-0.418571428571429,-0.391428571428571,-0.364285714285714,-0.337142857142857,-0.31,-0.282857142857143,-0.255714285714286,-0.228571428571429,-0.201428571428571,-0.174285714285714,-0.147142857142857,-0.12,-0.0928571428571429,-0.0657142857142857,-0.0385714285714286,-0.0114285714285715,0.0157142857142857,0.0428571428571428,0.07,0.0971428571428571,0.124285714285714,0.151428571428571,0.178571428571429,0.205714285714286,0.232857142857143,0.26,0.287142857142857,0.314285714285714,0.341428571428571,0.368571428571429,0.395714285714286,0.422857142857143,0.45
}

M.nfftVout = {
cvector{
0.93300408508746213165 + 0i,
0.069561741318968028924 + 0i,
},
cvector{
2.7421670155949744441 + 0i,
-0.31031966779210795604 + -0.56583917762794189166i,
-0.11639602719789787777 + 0i,
-0.31031966779210795604 + 0.56583917762794189166i,
},
cvector{
4.1222664410603844232 + 0i,
-0.32715120711263040443 + -0.20774933288534391806i,
0.032462782625719555085 + -0.77231287167924234094i,
-0.52519211286727285337 + 0i,
0.032462782625719555085 + 0.77231287167924234094i,
-0.32715120711263040443 + 0.20774933288534391806i,
},
cvector{
4.6498179502727357004 + 0i,
0.39220245149427462872 + 0.46105213502544922788i,
-0.40596642324484077946 + -1.3227403384282701015i,
-0.16964645397841454644 + -0.19084968716916078657i,
-0.27273379318905321966 + 0i,
-0.16964645397841454644 + 0.19084968716916078657i,
-0.40596642324484077946 + 1.3227403384282701015i,
0.39220245149427462872 + -0.46105213502544922788i,
},
cvector{
6.4946680076869771625 + -1.2478864599032139614e-15i,
-0.24369561099706421592 + 0.38141441973995482417i,
0.38313430277670479374 + -0.28039977286432077319i,
-0.66539598673166744369 + -1.6856809807749417729i,
-0.083526442571863104836 + 0.39311329504307013227i,
-0.26287140060704494715 + 0i,
-0.083526442571863104836 + -0.39311329504307013227i,
-0.66539598673166744369 + 1.6856809807749417729i,
0.38313430277670479374 + 0.28039977286432077319i,
-0.24369561099706421592 + -0.38141441973995482417i,
},
cvector{
7.8265794029032322854 + 0i,
-0.30185999621372333612 + 0.39286336609858635294i,
0.31049293402575611767 + 0.081010807643425830626i,
-0.096947581868655888226 + -1.1188205176064685009i,
-0.68586773071219697684 + -1.4142725025417135498i,
0.047644166826204349674 + 0.75901959869592905417i,
-0.35810802857942114485 + 0i,
0.047644166826204349674 + -0.75901959869592905417i,
-0.68586773071219697684 + 1.4142725025417135498i,
-0.096947581868655888226 + 1.1188205176064685009i,
0.31049293402575611767 + -0.081010807643425830626i,
-0.30185999621372333612 + -0.39286336609858635294i,
},
cvector{
11.440883440095657164 + 6.9604335183617508042e-16i,
-0.1209561614372134386 + 1.1315485427107492278i,
0.12626465729155142426 + -0.73194136228620976237i,
-0.33750187469282444397 + 0.85641636549127009292i,
0.86772183787577317204 + -0.74687202373968675229i,
-0.76825852872657607318 + -1.9713805231812395746i,
-0.72835993544244970188 + -0.78454615117964432436i,
-0.00083891252769280951363 + -0.42184261997404248756i,
0.018888765153594128804 + 1.2369566930706623609i,
-0.53171069742611243303 + 0i,
0.018888765153594128804 + -1.2369566930706623609i,
-0.00083891252769271085123 + 0.42184261997404270961i,
-0.72835993544244970188 + 0.78454615117964432436i,
-0.76825852872657596215 + 1.9713805231812395746i,
0.86772183787577317204 + 0.74687202373968664126i,
-0.33750187469282444397 + -0.85641636549127009292i,
0.12626465729155147977 + 0.73194136228620976237i,
-0.1209561614372134386 + -1.1315485427107492278i,
},
cvector{
15.278059534807704622 + -4.7015325293012420337e-16i,
-0.21469527631695375924 + 1.6201698480667960922i,
0.27682176200239744235 + -0.33161492965363209562i,
-0.28822578941915971695 + -0.47222609360966688596i,
-0.11181532328678196742 + 1.1293871576033167603i,
0.57692603827861321797 + -0.56064669098490438337i,
0.3309137344166484529 + -1.2654028266891295118i,
-1.0938558811821466055 + -2.136338852631368912i,
-0.58083094181947203527 + -0.65948955548316456898i,
-0.54806334006597234865 + -0.4032323268081004497i,
0.94862481890242644766 + 0.032306313013923095012i,
-1.2991630666784506065 + 1.6145588162312607405i,
0.75945691240715740289 + 0i,
-1.2991630666784506065 + -1.6145588162312602964i,
0.94862481890242678073 + -0.032306313013923095012i,
-0.54806334006597234865 + 0.4032323268081004497i,
-0.58083094181947225731 + 0.65948955548316445796i,
-1.0938558811821463834 + 2.1363388526313693561i,
0.3309137344166484529 + 1.2654028266891295118i,
0.57692603827861332899 + 0.56064669098490382826i,
-0.11181532328678207844 + -1.1293871576033167603i,
-0.28822578941915971695 + 0.47222609360966688596i,
0.2768217620023977199 + 0.33161492965363209562i,
-0.21469527631695384251 + -1.6201698480667967583i,
},
}
M.fftVOut = {
cvector {
  0.501282913203215 + 0i
},
cvector {
  0.933004085087463  + 0i,
  0.0695617413189681 + 0i,
},
cvector {
 1.93056443459965  + 0.00000000000000i ,
-0.213357847495003 + 0.490031102282293i,
-0.213357847495003 - 0.490031102282293i,
},
cvector {
 2.742167015594974 + 0.00000000000000i ,
-0.496277436308974 + 0.379881409111076i,
 0.255519509835835 + 0.00000000000000i ,
-0.496277436308974 - 0.379881409111076i,
},
cvector {
 3.22781868549299  + 0.00000000000000i  ,
-0.678876844881785 - 0.0580122823203923i,
 0.318174785143326 + 0.208555898884954i ,
 0.318174785143326 - 0.208555898884954i ,
-0.678876844881785 + 0.0580122823203923i,
},
cvector {
 4.25981303582745  + 0.00000000000000i  ,
-0.733581544166994 - 0.471947091741858i ,
-0.521206686549124 + 0.0127785555600641i,
 0.879371909013646 - 0.364799534517805i ,
 0.879371909013646 + 0.364799534517805i ,
-0.521206686549124 - 0.0127785555600641i,
-0.733581544166994 + 0.471947091741858i ,
},
cvector {
 5.57717417527086   + 0.00000000000000i ,
 0.0119009463917987 - 0.723670343605695i,
 0.0160422950287431 + 0.601289594881306i,
-0.612938954187026  + 1.30941878313523i ,
 0.0521817345455225 - 0.426288884452935i,
 0.0521817345455225 + 0.426288884452935i,
-0.612938954187026  - 1.30941878313523i ,
 0.0160422950287431 - 0.601289594881306i,
 0.0119009463917987 + 0.723670343605695i,
},
cvector {
 7.20824201928129   + 0.00000000000000i  ,
 0.449204707622447  - 0.0914031712646190i,
-1.20200684824244   + 0.667145426379437i ,
-0.715964404820187  - 0.427490159542938i ,
 0.530158288056011  + 1.01639757197465i  ,
 0.0915432703612051 - 0.452018533709828i ,
 0.0915432703612051 + 0.452018533709828i ,
 0.530158288056011  - 1.01639757197465i  ,
-0.715964404820187  + 0.427490159542938i ,
-1.20200684824244   - 0.667145426379437i ,
 0.449204707622447  + 0.0914031712646190i,
},
cvector {
 8.16986729314458   + 0.00000000000000i  ,
-0.0841303170186953 + 0.0355138100142128i,
-1.47587634920328   - 0.887174652428249i ,
 0.367370459447252  - 0.0930772829653667i,
-0.932630857483073  + 0.427389845013072i ,
 1.046036628133315  + 0.3545526668962236i,
 0.252635725373093  - 0.485181528655700i ,
 0.252635725373093  + 0.485181528655700i ,
 1.046036628133315  - 0.3545526668962236i,
-0.932630857483073  - 0.427389845013072i ,
 0.367370459447252  + 0.0930772829653667i,
-1.47587634920328   + 0.887174652428249i ,
-0.0841303170186953 - 0.0355138100142128i,
},
cvector {
 11.83916566831443  + 0.00000000000000i  ,
-0.153214842762162  - 0.263466943583459i ,
 0.545451663533672  - 0.303864692880962i ,
-1.759909435387384  - 0.332794085155040i ,
-0.409044333058155  + 0.752163648932480i ,
-0.702173011127814  - 1.15226534617531i  ,
-0.295060437367656  + 0.440227192535353i ,
 0.721786443295980  + 1.43235902486171i  ,
-0.0438705941509932 - 0.885815529340458i ,
 0.9386393882978409 - 1.362324078579285i ,
 0.9386393882978409 + 1.362324078579285i ,
-0.0438705941509932 + 0.885815529340458i ,
 0.721786443295980  - 1.43235902486171i  ,
-0.295060437367656  - 0.440227192535353i ,
-0.702173011127814  + 1.15226534617531i  ,
-0.409044333058155  - 0.752163648932480i ,
-1.759909435387384  + 0.3327940851550401i,
 0.545451663533672  + 0.303864692880962i ,
-0.153214842762162  + 0.263466943583459i ,
},
cvector {
 15.82736806782601  + 0.00000000000000i  ,
 0.178400049954600  - 0.123548986509432i ,
-0.0390954410039801 + 0.186557426495575i ,
 0.542326748736595  - 1.05113036729845i  ,
-1.49893100629637   + 0.0903027111787905i,
-0.584445640854081  + 1.187934183118395i ,
 0.174063505682597  + 0.373046889393661i ,
-2.37327100132364   - 0.218620781704302i ,
-0.681328331584369  - 0.429325082499419i ,
 0.565525320530959  + 0.939024123353414i ,
 1.85853798781298   - 0.496198931551420i ,
-0.0819062367790781 + 0.548181747723722i ,
 0.292476426250971  - 1.70335037649707i  ,
 0.292476426250971  + 1.70335037649707i  ,
-0.0819062367790781 - 0.548181747723722i ,
 1.85853798781298   + 0.496198931551420i ,
 0.565525320530959  - 0.939024123353414i ,
-0.681328331584369  + 0.429325082499419i ,
-2.37327100132364   + 0.218620781704302i ,
 0.174063505682597  - 0.373046889393661i ,
-0.584445640854081  - 1.187934183118395i ,
-1.49893100629637   - 0.0903027111787905i,
 0.542326748736595  + 1.05113036729845i  ,
-0.0390954410039801 - 0.186557426495575i ,
 0.178400049954600  + 0.123548986509432i ,
},
}

M.fftMIn = matrix {
 { 0.419048293624883, 0.505636617571756 , 0.355073651878849, 0.0251349857102031, 0.571025872824379, 0.0875003495765857, 0.383868601071971 },
 { 0.390762082204175, 0.635661388861377 , 0.997003271606648, 0.421112253765241 , 0.176855057625303, 0.640116548246715 , 0.627346502443467 },
 { 0.816140102875323, 0.950894415378135 , 0.224171498983127, 0.184100289427511 , 0.957384022595723, 0.180616887753108 , 0.0216498146303065},
 { 0.317427863655850, 0.443964155018810 , 0.652451072968615, 0.725775267469453 , 0.265322036192920, 0.0450511074735742, 0.910569988523029 },
 { 0.814539772900651, 0.0600188197794760, 0.604990641908259, 0.370362686515198 , 0.924580895239601, 0.723173479183095 , 0.800558656278811 },
 { 0.789073514938958, 0.866749896999319 , 0.387245431483135, 0.841560087468206 , 0.223770404697041, 0.347437645581790 , 0.745847484342721 },
 { 0.852263890343846, 0.631188734269011 , 0.142187159290504, 0.734229691193313 , 0.373563807642645, 0.660616824502904 , 0.813112813610761 },
}

M.fftMOut = {
cmatrix{
  { 1.95110838226219 ,-0.331487630604076},
  {-0.101738559868912, 0.158310982710329},
},
cmatrix{
  { 4.497313475672814 + 0i,-0.0612760364894603 - 0.906595203085707i, -0.162854761774302 + 0.630250468368240i , -0.162854761774302 - 0.630250468368240i ,-0.0612760364894603 + 0.906595203085707i},
  {-0.745474632452673 + 0i, 0.949596138780768  + 0.643106793423136i, -0.506143294002660 + 0.0741998482983635i, -0.506143294002660 - 0.0741998482983635i, 0.949596138780768  - 0.643106793423136i},
},
cmatrix{
  { 6.23614547701155 + 0i, 0.613232631400580  - 0.579632464208007i,-0.798381503457604 - 0.0917051178650304i,-0.0985875510470513 + 0.725852755877514i,-0.0985875510470513 - 0.725852755877514i,-0.798381503457604 + 0.0917051178650304i, 0.613232631400580  + 0.579632464208007i },
  {-1.54156873249430 + 0i, 0.0628501129975938 + 0.341205323057886i, 1.18652066370276  - 0.767122911622934i ,-0.379584670480724  + 0.651283908437080i,-0.379584670480724  - 0.651283908437080i, 1.18652066370276  + 0.767122911622934i , 0.0628501129975938 - 0.341205323057886i },
},
cmatrix{
  { 5.35409351187044  + 0.00000000000000i , 0.161742718651327 + 0.00000000000000i  },
  {-0.533419362507429 - 0.735533912515786i, 0.282281964509739 + 0.955335582208654i },
  { 0.168084884563810 + 0.867158916431620i,-0.579624133702585 + 0.579628686983935i },
  { 0.168084884563810 - 0.867158916431620i,-0.579624133702585 - 0.579628686983935i },
  {-0.533419362507429 + 0.735533912515786i, 0.282281964509739 - 0.955335582208654i },
},
cmatrix{
  { 12.80943701658147 + 0.00000000000000i , 0.765576936960699 - 0.366439813249418i, -0.275500157099229 + 1.22875757640977i ,-0.275500157099229 - 1.22875757640977i , 0.765576936960699 + 0.366439813249418i},
  {-0.936697200456165 - 0.282155103031546i,-1.335782971421896 - 0.220944899288107i, -0.137004056778301 + 1.36528416610757i , 0.470513329623128 - 0.177874501935689i, 1.31112740403901  - 0.134805487620054i},
  {-0.778222753809393 + 0.782120511533158i,-0.221812735740264 + 1.96080356088917i , -1.33775170330437  - 1.15184543839904i ,-0.392752551883637 - 0.141054985612529i, 1.70169162189072  + 2.16694536012813i },
  {-0.778222753809393 - 0.782120511533158i, 1.70169162189072  - 2.16694536012813i , -0.392752551883637 + 0.141054985612529i,-1.33775170330437  + 1.15184543839904i ,-0.221812735740264 - 1.96080356088917i },
  {-0.936697200456165 + 0.282155103031546i, 1.31112740403901  + 0.134805487620054i,  0.470513329623128 + 0.177874501935689i,-0.137004056778301 - 1.36528416610757i ,-1.335782971421896 + 0.220944899288107i},
},
cmatrix{
  { 17.22988895176213 + 0.00000000000000i , 0.919890740881488 - 0.505576362304875i, 0.387669076427398 - 0.267496593006588i,-0.269790889776869  + 2.108277218983274i,-0.269790889776869  - 2.108277218983274i, 0.387669076427398 + 0.267496593006588i, 0.919890740881488 + 0.505576362304875i},
  {-0.539552409137895 + 0.404381882281168i,-1.279790403887846 + 0.244363571701843i,-2.22600253207360  + 0.695573864313634i,-0.0139067287875584 + 0.490391166252702i, 1.19455647066881   - 0.393033660244273i, 0.604479771558202 + 0.530429331126393i, 1.38123493866797  - 1.20280031150643i },
  {-2.20717113609660  + 0.216269095055060i,-0.479569128772819 - 0.815033714024553i, 3.60534973898368  + 0.593547081269266i,-1.63205678539663   + 1.07961350501846i ,-0.474232620527191  + 0.628473889712229i,-1.40114815428279  + 2.63826509516983i , 1.14844071410664  + 0.722621659754145i},
  {-2.20717113609660  - 0.216269095055060i, 1.14844071410664  - 0.722621659754145i,-1.40114815428279  - 2.63826509516983i ,-0.474232620527191  - 0.628473889712229i,-1.63205678539663   - 1.07961350501846i , 3.60534973898368  - 0.593547081269266i,-0.479569128772819 + 0.815033714024553i},
  {-0.539552409137895 - 0.404381882281168i, 1.38123493866797  + 1.20280031150643i , 0.604479771558202 - 0.530429331126393i, 1.19455647066881   + 0.393033660244273i,-0.0139067287875584 - 0.490391166252702i,-2.22600253207360  - 0.695573864313634i,-1.279790403887846 - 0.244363571701843i},
},
cmatrix{
  { 8.49336954842157  + 0.00000000000000i , 0.305141492665801 + 0.00000000000000i },
  { 0.253968947098506 + 0.297998105230324i,-0.619966792082123 + 0.802236784161341i},
  {-1.69770497355974  + 0.405345978793009i, 0.501648523009691 - 0.259311967394301i},
  { 0.433448441438688 + 0.395575113868065i,-0.337311611074524 + 1.01652071912703i },
  { 0.433448441438688 - 0.395575113868065i,-0.337311611074524 - 1.01652071912703i },
  {-1.69770497355974  - 0.405345978793009i, 0.501648523009691 + 0.259311967394301i},
  { 0.253968947098506 - 0.297998105230324i,-0.619966792082123 - 0.802236784161341i},
},
cmatrix{
  { 18.65126963490744 + 0.00000000000000i , 1.351228584959366 - 0.607932190804994i , 0.321275398946127  - 0.295749241098964i, 0.321275398946127  + 0.295749241098964i, 1.351228584959366 + 0.607932190804994i },
  {-0.840681521381663 + 0.224256614743899i,-0.352089009567039 - 0.748477837615256i , 0.809003117934405  + 0.788732823782512i,-1.617868107096484  + 1.289645901094046i, 1.08664090765174  + 1.19642972147396i  },
  {-1.709345461492674 - 0.169158078731520i,-1.15083880288700  + 1.32591208837964i  , 1.453253599694095  + 1.121002403590665i,-1.15950496219855   - 1.85578924292972i ,-0.423705499490998 - 0.0568821418122896i},
  {-0.209889858944142 + 0.427890433344013i,-0.128461727080120 + 2.16315961508514i  ,-2.19260260837304   - 0.345343607460024i, 0.0449503658740813 - 0.630790387683251i, 2.72634590443363  + 1.91532352920186i  },
  {-0.209889858944142 - 0.427890433344013i, 2.72634590443363  - 1.91532352920186i  , 0.0449503658740813 + 0.630790387683251i,-2.19260260837304   + 0.345343607460024i,-0.128461727080120 - 2.16315961508514i  },
  {-1.709345461492674 + 0.169158078731520i,-0.423705499490998 + 0.0568821418122896i,-1.15950496219855   + 1.85578924292972i , 1.453253599694095  - 1.121002403590665i,-1.15083880288700  - 1.32591208837964i  },
  {-0.840681521381663 - 0.224256614743899i, 1.08664090765174  - 1.19642972147396i  ,-1.617868107096484  - 1.289645901094046i, 0.809003117934405  - 0.788732823782512i,-0.352089009567039 + 0.748477837615256i },
},
cmatrix{
  { 25.63873633812628 + 0.00000000000000i , 2.16713333513509  - 0.415781832332589i, 1.31847514689736  + 0.349316248420165i,-0.907582329192691 + 0.806628232011587i,-0.907582329192691 - 0.806628232011587i, 1.31847514689736  - 0.349316248420165i, 2.16713333513509  + 0.415781832332589i},
  {-1.18231436212554  + 1.50069520388816i ,-0.716750923749597 + 0.124086313661985i,-2.01794228788444  - 0.248178952054741i, 1.24557726556602  - 0.640401462479195i,-1.36984958660323  + 0.472852792882833i, 0.744782064092640 + 1.77463933216583i , 2.01550537326149  + 0.867128884805955i},
  {-1.46934968075447  - 0.798828528457664i,-0.577451929269762 + 1.25240452875269i ,-0.533161331687621 + 2.76104471640787i , 0.841992124276231 + 0.515515722616510i,-0.523315090027708 - 2.82126493678820i ,-1.045689981800223 + 0.234925743308899i,-0.879221687661628 - 0.632678205944625i},
  {-1.95219482327794  + 0.374627203032898i,-1.53693393702035  - 1.15624986631040i , 3.77598083138551  - 0.657897725323786i,-1.485498910639894 + 2.283279359506245i, 0.525073751274065 + 0.493455670459441i,-0.883957380145181 + 3.20061731518266i , 1.89400937469837  + 0.404503458935778i},
  {-1.95219482327794  - 0.374627203032898i, 1.89400937469837  - 0.404503458935778i,-0.883957380145181 - 3.20061731518266i , 0.525073751274065 - 0.493455670459441i,-1.485498910639894 - 2.283279359506245i, 3.77598083138551  + 0.657897725323786i,-1.53693393702035  + 1.15624986631040i },
  {-1.46934968075447  + 0.798828528457664i,-0.879221687661628 + 0.632678205944625i,-1.045689981800223 - 0.234925743308899i,-0.523315090027708 + 2.82126493678820i , 0.841992124276231 - 0.515515722616510i,-0.533161331687621 - 2.76104471640787i ,-0.577451929269762 - 1.25240452875269i },
  {-1.18231436212554  - 1.50069520388816i , 2.01550537326149  - 0.867128884805955i, 0.744782064092640 - 1.77463933216583i ,-1.36984958660323  - 0.472852792882833i, 1.24557726556602  + 0.640401462479195i,-2.01794228788444  + 0.248178952054741i,-0.716750923749597 - 0.124086313661985i},
},
}

-- rotations ------------------------------------------------------------------o

local r4, r3 = sqrt(2)/2,  sqrt(3)/2

M.rad = { pi/6, pi/4, pi/3, pi/2, pi }

M.rot = {
  matrix{ { r3 ,-0.5},{ 0.5, r3 } },
  matrix{ { r4 ,-r4 },{ r4 , r4 } },
  matrix{ { 0.5,-r3 },{ r3 , 0.5} },
  matrix{ { 0  ,-1  },{ 1  , 0  } },
  matrix{ {-1  , 0  },{ 0  ,-1  } },
}

M.rotx = {
  matrix{ { 1, 0  , 0  },
          { 0, r3 ,-0.5},
          { 0, 0.5, r3 } },
  matrix{ { 1, 0  , 0  },
          { 0, r4 ,-r4 },
          { 0, r4 , r4 } },
  matrix{ { 1, 0  , 0  },
          { 0, 0.5,-r3 },
          { 0, r3 , 0.5} },
  matrix{ { 1, 0  , 0  },
          { 0, 0  ,-1  },
          { 0, 1  , 0  } },
  matrix{ { 1, 0  , 0  },
          { 0,-1  , 0  },
          { 0, 0  ,-1  } },
}

M.roty = {
  matrix{ { r3 , 0, 0.5},
          { 0  , 1, 0  },
          {-0.5, 0, r3 } },
  matrix{ { r4 , 0, r4 },
          { 0  , 1, 0  },
          {-r4 , 0, r4 } },
  matrix{ { 0.5, 0, r3 },
          { 0  , 1, 0  },
          {-r3 , 0, 0.5} },
  matrix{ { 0  , 0, 1  },
          { 0  , 1, 0  },
          {-1  , 0, 0  } },
  matrix{ {-1  , 0, 0  },
          { 0  , 1, 0  },
          { 0  , 0,-1  } },
}

M.rotz = {
  matrix{ { r3 ,-0.5, 0},
          { 0.5, r3 , 0},
          { 0  , 0  , 1} },
  matrix{ { r4 ,-r4 , 0},
          { r4 , r4 , 0},
          { 0  , 0  , 1} },
  matrix{ { 0.5,-r3 , 0},
          { r3 , 0.5, 0},
          { 0  , 0  , 1} },
  matrix{ { 0  ,-1  , 0},
          { 1  , 0  , 0},
          { 0  , 0  , 1} },
  matrix{ {-1  , 0  , 0},
          { 0  ,-1  , 0},
          { 0  , 0  , 1} },
}

-- end ------------------------------------------------------------------------o

return M
